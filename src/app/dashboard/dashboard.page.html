<ion-header [translucent]="true">
  <ion-toolbar class="custom-toolbar">
    <ion-title>
      <div class="header-content">
        <div>
          <h2 class="greeting">{{ greeting() }}</h2>
          <p class="user-name">{{ user()?.name || 'Fitness Enthusiast' }}</p>
        </div>
        <ion-icon name="trophy" class="trophy-icon"></ion-icon>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="content-wrapper" *ngIf="todayActivity() as activity">
    <!-- Daily Activity Summary -->
    <div class="section-header">
      <h3>Today's Activity</h3>
      <ion-text color="medium">{{ activity.workoutsCompleted }} workouts</ion-text>
    </div>

    <!-- Activity Cards -->
    <ion-grid class="activity-grid">
      <ion-row>
        <ion-col size="6">
          <div class="stat-card gradient-purple animate-scale">
            <div class="stat-icon-wrapper">
              <ion-icon name="walk"></ion-icon>
            </div>
            <div class="stat-content">
              <h2 class="stat-value">{{ activity.steps.toLocaleString() }}</h2>
              <p class="stat-label">Steps</p>
              <ion-progress-bar 
                [value]="stepProgress()" 
                class="custom-progress"
              ></ion-progress-bar>
              <p class="stat-goal">Goal: {{ (user()?.dailyStepGoal || 10000).toLocaleString() }}</p>
            </div>
          </div>
        </ion-col>

        <ion-col size="6">
          <div class="stat-card gradient-orange animate-scale delay-1">
            <div class="stat-icon-wrapper">
              <ion-icon name="flame"></ion-icon>
            </div>
            <div class="stat-content">
              <h2 class="stat-value">{{ activity.caloriesBurned }}</h2>
              <p class="stat-label">Calories</p>
              <ion-progress-bar 
                [value]="calorieProgress()" 
                class="custom-progress"
              ></ion-progress-bar>
              <p class="stat-goal">Goal: {{ user()?.dailyCalorieGoal || 2000 }}</p>
            </div>
          </div>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col size="12">
          <div class="stat-card gradient-green animate-scale delay-2">
            <div class="stat-row">
              <div class="stat-item">
                <ion-icon name="time"></ion-icon>
                <div>
                  <h3>{{ activity.activeMinutes }}</h3>
                  <p>Active Minutes</p>
                </div>
              </div>
              <div class="stat-divider"></div>
              <div class="stat-item">
                <ion-icon name="trending-up"></ion-icon>
                <div>
                  <h3>{{ (weeklyProgress()?.totalSteps ?? 0) | number }}</h3>
                  <p>Weekly Steps</p>
                </div>
              </div>
            </div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- Weekly Progress -->
    <div class="section-header">
      <h3>Weekly Progress</h3>
      <ion-text color="medium">Last 7 days</ion-text>
    </div>

    <div class="weekly-chart animate-fade-in" *ngIf="weeklyProgress() as progress">
      <div class="chart-container">
        <div class="chart-bar" *ngFor="let day of progress.days">
          <div class="bar-wrapper">
            <div 
              class="bar"
              [style.height.%]="getBarHeight(day.steps)"
            >
              <span class="bar-value">{{ (day.steps / 1000).toFixed(1) }}k</span>
            </div>
          </div>
          <span class="bar-label">{{ getWeekDayLabel(day.date) }}</span>
        </div>
      </div>
    </div>

    <!-- Quick Navigation -->
    <div class="section-header">
      <h3>Quick Access</h3>
    </div>

    <div class="quick-nav animate-fade-in">
      <div class="nav-card gradient-blue" (click)="navigateTo('/tabs/workouts')">
        <div class="nav-icon">
          <ion-icon name="fitness"></ion-icon>
        </div>
        <div class="nav-content">
          <h4>Workouts</h4>
          <p>Start your training</p>
        </div>
        <ion-icon name="chevron-forward" class="nav-arrow"></ion-icon>
      </div>

      <div class="nav-card gradient-pink" (click)="navigateTo('/tabs/diet')">
        <div class="nav-icon">
          <ion-icon name="nutrition"></ion-icon>
        </div>
        <div class="nav-content">
          <h4>Diet Plan</h4>
          <p>Track your meals</p>
        </div>
        <ion-icon name="chevron-forward" class="nav-arrow"></ion-icon>
      </div>

      <div class="nav-card gradient-teal" (click)="navigateTo('/tabs/settings')">
        <div class="nav-icon">
          <ion-icon name="bar-chart"></ion-icon>
        </div>
        <div class="nav-content">
          <h4>Analytics</h4>
          <p>View detailed stats</p>
        </div>
        <ion-icon name="chevron-forward" class="nav-arrow"></ion-icon>
      </div>
    </div>
  </div>
</ion-content>
